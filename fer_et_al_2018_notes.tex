\documentclass[12pt]{article}
\RequirePackage[l2tabu, orthodox]{nag}
\usepackage[main=english]{babel}
\usepackage[rm={lining,tabular},sf={lining,tabular},tt={lining,tabular,monowidth}]{cfr-lm}
\usepackage{amsthm,amssymb,latexsym,gensymb,mathtools,mathrsfs}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[pdftex]{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{epstopdf,enumitem,microtype,dcolumn,booktabs,hyperref,url,fancyhdr}

% Plotting
\usepackage{pgfplots}
\usepackage{xinttools} % for the \xintFor***
\usepgfplotslibrary{fillbetween}
\pgfplotsset{compat=1.8}
\usepackage{tikz}

% Custom Commands
\newcommand*{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand*{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand*{\suchthat}{\,\mathrel{\big|}\,}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\R}{\mathcal{R}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\Ker}{\mathrm{Ker}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Prob}{\mathbb{P}}
\DeclarePairedDelimiterX\innerp[2]{(}{)}{#1\delimsize\vert\mathopen{}#2}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\def\R{\mathbb{R}}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
\newcommand*{\vertbar}{\rule[-1ex]{0.5pt}{2.5ex}} % For lines in matrix to represent columns
\newcommand*{\horzbar}{\rule[.5ex]{2.5ex}{0.5pt}} % For lines in matrix to represent rows

\setlist{topsep=1ex,parsep=1ex,itemsep=0ex}
\setlist[1]{leftmargin=\parindent}
\setlist[enumerate,1]{label=\arabic*.,ref=\arabic*}
\setlist[enumerate,2]{label=(\alph*),ref=(\alph*)}

% Specifically for paper formatting 
\renewcommand{\baselinestretch}{1.2} % Spaces manuscript for easy reading

% Formatting definitions, propositions, etc. 
\newtheorem{definition}{Definition}
\newtheorem{prop}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem{thm}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{notation}{Notation}

\begin{document}

\begin{center}
\Large
Notes on Bayesian emulation procedure described in Fer et al 2018
\end{center}

\begin{flushright}
Andrew Roberts
\end{flushright} 

% Goals
\section{Goals}
\begin{itemize}
\item Calibrate parameters of (deterministic) computer simulator to real-world data
\item Limited computationally so can only run full simulation at a limited number of points in parameter space; hence also interested in interpolating between the 
outputs observed outputs at these points and quantifying the interpolation uncertainty
\end{itemize}

% My Notation
\section{My Notation}
Let $\mathcal{P} \subset \R^d$ be the parameter space (meaning the set of possible simulation parameters). Denote the deterministic simulator by the function $f: \mathcal{P} \to \R$, 
where for simplicity I'm assuming only a single scalar output for now. For a given parameter value $x_i \in \mathcal{P}$ I denote the simulation output by $y_i = f(x_i)$.
 We assume a prior distribution $\pi_0$ over $\mathcal{P}$; looks like they assume a non-informative prior in the paper. 
With the goal of parameter calibration in mind, we assume that we observe some real-world data $z = (z_1, \dots, z_N)$, which is characterized by some assumed error model that depends on the simulator parameter
$x$. For concreteness, I'll just consider the following Gaussian noise model. 
\begin{align*}
&z_i|x \overset{ind}{\sim} N(f(x), \sigma^2), \qquad i = 1, \dots, N \\
&\sigma^2|x \sim p_0 \\
&x \sim \pi_0
\end{align*}
I guess I am implicitly assuming here that the simulation parameters $x$ have some sort of real physical meaning, given that I'm modeling the real-world data $z_i$ conditional on $x$. 
I'm considering something like $x$ including some site-specific property of the soil, for instance. When running the simulation at a specific site, we don't know the correct setting for this soil 
property, but we observe outputs $z$ that give us information about the property, and moreover the simulation $f$ is parameterized by this property. We are ultimately interested in the 
posterior $p(x|z)$. 

% Brute-Force Approach
\section{Brute-Force Approach}
Fer et al contrast their Bayesian emulation approach with what they call a ``brute-force'' approach. I believe this is just the straightforward approach of using MCMC to sample from 
$p(x|z) \propto p(z|x)\pi_0(x)$. The likelihood is obtained by marginalizing over $\sigma^2$: 
\[p(z|x) = \int p(z|\sigma^2, x)p_0(\sigma^2|z) = \int N(z|f(x), \sigma^2) p_0(\sigma^2|z)\] 
The key observation is that the likelihood depends on $f(x)$ so at each step of MCMC the full simulation must be run on the current proposed parameter value $x$. This is costly considering 
this is not parallelizable. 


\end{document}


