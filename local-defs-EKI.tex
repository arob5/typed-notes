%!TEX root = SMA-book.tex

% Useful info on newcomand: https://tex.stackexchange.com/questions/117358/newcommand-argument-confusion


% --------------------------------------------------------------------------------------------------
% General Math.  
% --------------------------------------------------------------------------------------------------

% Common math commands. 
\newcommand*{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand{\R}{\mathbb{R}}
\newcommand*{\suchthat}{\,\mathrel{\big|}\,}
\newcommand{\Exp}[1]{\exp\mathopen{}\left\{#1\right\}\mathclose{}}
\newcommand{\Log}[1]{\log\mathopen{}\left\{#1\right\}\mathclose{}}
\newcommand{\BigO}{\mathcal{O}}

\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\DeclarePairedDelimiterX\innerp[2]{(}{)}{#1\delimsize\vert\mathopen{}#2}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}

% Linear algebra.
\newcommand*{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand*{\wnorm}[2]{\left\lVert#1\right\rVert_{#2}} % Weighted norm
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\oneVec}[1][]{\boldsymbol{1}_{#1}}
\newcommand{\idMat}{\mathbf{I}}
\newcommand{\bS}{\mathbf{S}}
\newcommand{\bK}{\mathbf{K}}
\newcommand{\ba}{\mathbf{a}}
\newcommand{\bb}{\mathbf{b}}

% Probability. 
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\Gaussian}{\mathcal{N}}

% --------------------------------------------------------------------------------------------------
% Bayesian Inverse Problems. 
% --------------------------------------------------------------------------------------------------

% General inverse problems.

\newcommand{\spar}{u} % Parameter (scalar, non-bold)
\newcommand{\bpar}{\mathbf{u}} % Parameter vector (bold)
\newcommand{\parSpace}{\mathcal{U}} % Parameter space
\newcommand{\fwd}{G} % Forward model
\newcommand{\Npar}{D} % Dimension of parameter space
\newcommand{\Nobj}{P} % Number of output variables/data constraints/objectives
\newcommand{\llik}{\mathcal{L}} % Log-likelihood 
\newcommand{\priorDens}{\pi_0} % Prior density 
\newcommand{\postDens}{\pi} % Posterior density
\newcommand{\objIdx}{p} % Primary index for indexing objective (i.e. data constraint or output variable) in multi-objective problems.
\newcommand{\indexObj}[2][\objIdx]{{#2}^{(#1)}} % Adds objective index to a variable.
\newcommand{\designMat}[1][\designIdx]{\mathbf{U}_{#1}} % Design matrix of input parameters (in rows) at which response is observed. 
\newcommand{\logUnPost}{\ell^{\postDens}} % Log unnormalized posterior density. 

% Gaussian likelihood, Inverse Gamma prior model. 

\newcommand{\IGShape}{\alpha} % Shape parameter for inverse Gamma prior.
\newcommand{\IGScale}{\beta} % Scale parameter for inverse Gamma prior. 
\newcommand{\sdObs}{\sigma} % Standard deviation for observation error of single objective in Gaussian likelihood. 
\newcommand{\CovObs}{\boldsymbol{\Sigma}} % Time-independent covariance matrix across all output variables/objectives
\newcommand{\SSR}{\Phi} % Sum of squared error (SSR) function, as a function of the parameter. 

\newcommand{\SSRVecPredOut}[2]{\SSR_{#1}^{(#2)}} % TODO: change this 


% --------------------------------------------------------------------------------------------------
% Gaussian Processes. 
% --------------------------------------------------------------------------------------------------

% Generic GP commands. 
\newcommand{\GP}{\mathcal{GP}} % GP distribution.
\newcommand{\LNP}{\mathcal{LNP}} % Log-normal process distribution. 
\newcommand{\f}{f} % Generic univariate target function on which GP prior is placed. 
\newcommand{\fObs}[1][\designIdx]{\mathbf{\f}_{#1}} % Vector of observed target function evaluations.  
\newcommand{\GPMean}{\mu} % Generic GP prior mean function
\newcommand{\GPKer}{k} % Generic GP prior covariance function
\newcommand{\designData}{\mathcal{D}} % Set of training/design inputs and responses  
\newcommand{\GPMeanPred}[1][\designIdx]{\GPMean_{#1}} % GP predictive mean (conditioned on data).
\newcommand{\GPKerPred}[1][\designIdx]{\GPKer_{#1}} % GP predictive covariance function (conditioned on data). 
\newcommand{\KerMat}[1][\designIdx]{\mathbf{K}_{#1}} % Generic kernel matrix, explicitly showing dependence on number of design points.

\newcommand{\bbf}{\mathbf{f}} % Bold version of target function; e.g. to be used to denote a vector of function evaluations. 
\newcommand{\GPMeanOut}[1]{\mu^{(#1)}} % Univariate GP prior mean function for specific output variable 
\newcommand{\GPMeanPredOut}[2]{\mu_{#1}^{(#2)}} % Univariate GP mean, conditioned on data, for specific output variable
\newcommand{\GPKerOut}[1]{k^{(#1)}} % Univariate GP prior covariance function for specific output variable  
\newcommand{\GPKerPredOut}[2]{k_{#1}^{(#2)}} % Univariate GP covariance, conditioned on data, for specific output variable

\newcommand{\KerMatOut}[2]{\mathbf{K}_{#1}^{(#2)}} % Kernel matrix for specific output 

% GP emulators for high-dimensional outputs using basis function approach (Higdon et al). 
\newcommand{\fwdOutputMat}{\mathbf{M}} % In the case Nout = 1, this is the Ntime x Ndesign matrix of computer model outputs at the design points. 
\newcommand{\basisOutputVec}{\mathbf{v}} % Basis vector for representing computer model output. 
\newcommand{\basisMat}{\mathbf{V}} % Matrix containing basis vectors for computer model output as columns. 
\newcommand{\NbasisVec}{R} % Number of basis vectors used in representing computer model output. 
\newcommand{\basisVecIdx}{r} % Main index for indexing basis vectors used in representing computer model output. 
\newcommand{\basisVecWeight}{w} % Weight scaling basis vectors used in representing computer model output; these are emulated by GPs. 
\newcommand{\basisWeightMat}{\mathbf{W}} % Matrix of weights, of dimension Ndesign x NbasisVec
\newcommand{\centerVec}{\mathbf{m}} % Vector used to center the computer model outputs. 
\newcommand{\scaleVec}{\mathbf{s}} %  Vector used to scale the computer model outputs. 

% Loss emulation approach; emulating the L2 error functions. 
\newcommand{\SSRObs}{\mathbf{\SSR}} % Vector of observed SSR responses. 

% Induced approximation to unnormalized log posterior density and unnormalized posterior density. 
\newcommand{\logUnPostPred}[1][\designIdx]{\ell^{\postDens}_{#1}}
\newcommand{\unPostPred}[1][\designIdx]{\postDens_{#1}}
\newcommand{\logUnPostMean}{\mu}
\newcommand{\logUnPostKer}{k}
\newcommand{\logUnPostObs}[1][\designIdx]{\boldsymbol{\ell}^{\postDens}_{#1}}
\newcommand{\logUnPostBatch}{\tilde{\boldsymbol{\ell}}^{\postDens}}
\newcommand{\logUnPostObsBatch}[1][\designIdx]{\tilde{\boldsymbol{\ell}}^{\postDens}_{#1}}
\newcommand{\logUnPostMeanPred}[1][\designIdx]{\mu_{#1}}
\newcommand{\logUnPostKerPred}[1][\designIdx]{k_{#1}}
\newcommand{\GPMeanTarget}{m} % Underlying GP mean
\newcommand{\GPKerTarget}{C} % Underlying GP kernel
\newcommand{\GPMeanTargetPred}[1][\designIdx]{m_{#1}} 
\newcommand{\GPKerTargetPred}[1][\designIdx]{C_{#1}} 
 
% --------------------------------------------------------------------------------------------------
% Dynamical Models. 
% --------------------------------------------------------------------------------------------------

% ODEs

\newcommand{\timeStep}{k} % Primary index for discrete time 
\newcommand{\timeIdx}{t} % Primary index for continuous time 
\newcommand{\Ntimestep}{K}
\newcommand{\Ntime}{T}

\newcommand{\state}{v} % Generic state (scalar, non-bold)
\newcommand{\bstate}{\mathbf{\state}} % Generic state vector (bold)
\newcommand{\dataObsCum}[1][\timeStep]{Y_{#1}} % Observed data up through certain time 
\newcommand{\fwdOne}{\Psi} % One-step flow map
\newcommand{\indexTimeStep}[2][\timeStep]{{#2}_{#1}} % Adds discrete time index to a variable.
\newcommand{\dstate}[1][\timeStep]{\indexTimeStep[#1]{\state}} % State vector indexed by discrete time. 
\newcommand{\dstatePred}[1][\timeStep]{\indexTimeStep[#1]{\hat{\state}}}
\newcommand{\noiseDynamic}{\eta}
\newcommand{\CovNoiseDynamic}{\Sigma_{\noiseDynamic}}
\newcommand{\dimState}{D}
\newcommand{\stateMean}[1][\timeStep]{\indexTimeStep[#1]{m}}
\newcommand{\stateCov}[1][\timeStep]{\indexTimeStep[#1]{C}}
\newcommand{\stateMeanPred}[1][\timeStep]{\indexTimeStep[#1]{\hat{m}}}
\newcommand{\stateCovPred}[1][\timeStep]{\indexTimeStep[#1]{\hat{C}}}

\newcommand{\dataObs}{y}
\newcommand{\ddataObs}[1][\timeStep]{\indexTimeStep[#1]{\dataObs}} % Observation indexed by discrete time. 
\newcommand{\obsOp}{h} % Observation operator  
\newcommand{\obsOpLin}{H} % Linear observation operator
\newcommand{\noiseObs}{\epsilon}
\newcommand{\CovNoiseObs}{\Sigma_{\noiseObs}}
\newcommand{\dimObs}{N}

\newcommand{\filterMeas}[1][\timeStep]{\mu_{#1}} % Filtering distribution/law (measure)
\newcommand{\filterDens}[1][\timeStep]{\pi_{#1}} % Filtering density
\newcommand{\predictMeas}[1][\timeStep]{\hat{\mu}_{#1}} % Filtering distribution/law (measure)
\newcommand{\predictDens}[1][\timeStep]{\hat{\pi}_{#1}} % Filtering density
\newcommand{\filterDensPred}[1][\timeStep]{\hat{\pi}_{#1}} 
\newcommand{\predictOp}{\mathcal{P}} % Prediction operator (Markov kernel)
\newcommand{\analysisOp}[1][\timeStep]{\mathcal{A}_{#1}} % Analysis (likelihood) operator 
\newcommand{\KGain}[1][\timeStep]{K_{#1}} % Kalman Gain 

\newcommand{\NTimeOut}[1]{T_{#1}} % Number of time steps \NTimeOut -> \indexObj{\Ntime}
\newcommand{\indexTime}[2][\timeIdx]{{#2}_{#1}} % Adds time index to a variable.
\newcommand{\stateOut}[1]{\bstate^{(#1)}} % State vector for specific output variable
\newcommand{\stateTime}[1]{\bstate_{#1}} % State vector at specific time across all outputs 
\newcommand{\stateTimeOut}[2]{\state_{#1}^{(#2)}} % State at specific time and for specific output
\newcommand{\stateMat}{\mathbf{Y}} % Matrix of observed states across all time steps (rows) and output variables (columns) 
\newcommand{\bforce}{\mathbf{w}} % Forcing input (bold)

% --------------------------------------------------------------------------------------------------
% Experimental/Sequential Design and Optimization. 
% --------------------------------------------------------------------------------------------------

\newcommand{\Ninit}{N_0} % Initial number of design points/size of space-filling design 
\newcommand{\Ndesign}{N} % Total number of design points  
\newcommand{\Nbatch}{B} % Total number of design points  
\newcommand{\designIdx}{n} % Primary index for design points (sequential design)
\newcommand{\batchIdx}{b}  % Primary index for rounds in sequential batch design
\newcommand{\indexDesign}[2][\designIdx]{{#2}_{#1}} % Adds design iteration index to a variable.
\newcommand{\indexDesignObj}[3][\objIdx]{{#2}^{(#1)}_{#3}} % Adds design iteration index and objective/constraint index to a variable.
\newcommand{\currParMax}[1]{\bpar_{#1}^{\text{max}}} % Value of design point (calibration parameter) that currently has highest posterior density
\newcommand{\currMax}[1]{\postDens_{#1}^{\text{max}}} % Current max value of posterior density
\newcommand{\acq}[1][]{\mathcal{A}_{#1}} % Acquisition function
\newcommand{\batchMat}{\tilde{\mathbf{U}}} % Matrix of candidate points in batch acquisition. 

% --------------------------------------------------------------------------------------------------
% Markov Chain Monte Carlo. 
% --------------------------------------------------------------------------------------------------

% Generic MCMC commands. 
\newcommand{\propDens}{q} % Proposal density
\newcommand{\CovProp}{\mathbf{C}} % Proposal covariance matrix
\newcommand{\NMCMC}{T_{\text{MCMC}}} % Proposal covariance matrix
\newcommand{\accProbMH}{\alpha} % Metropolis-Hastings acceptance probability

